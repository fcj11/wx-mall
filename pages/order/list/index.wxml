<view class="order-container">
  <!-- é¡¶éƒ¨çŠ¶æ€åˆ‡æ¢ -->
  <view class="tab-bar">
    <view class="tab-item {{type === 'all' ? 'active' : ''}}" 
          bindtap="handleTabChange" 
          data-type="all">å…¨éƒ¨</view>
    <view class="tab-item {{type === 'unpaid' ? 'active' : ''}}" 
          bindtap="handleTabChange" 
          data-type="unpaid">å¾…ä»˜æ¬¾</view>
    <view class="tab-item {{type === 'unshipped' ? 'active' : ''}}" 
          bindtap="handleTabChange" 
          data-type="unshipped">å¾…å‘è´§</view>
    <view class="tab-item {{type === 'unreceived' ? 'active' : ''}}" 
          bindtap="handleTabChange" 
          data-type="unreceived">å¾…æ”¶è´§</view>
    <view class="tab-item {{type === 'unrated' ? 'active' : ''}}" 
          bindtap="handleTabChange" 
          data-type="unrated">å¾…è¯„ä»·</view>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <scroll-view scroll-y class="order-list" 
               enhanced="{{true}}" 
               show-scrollbar="{{false}}"
               bindscrolltolower="loadMore">
    <view class="order-item" 
          wx:for="{{orderList}}" 
          wx:key="id"
          bindtap="handleOrderClick"
          data-id="{{item.id}}">
      
      <!-- è®¢å•çŠ¶æ€ -->
      <view class="order-header">
        <text class="shop-name">æ·˜å® CCKOK</text>
        <text class="order-status">{{item.statusText}}</text>
      </view>
      
      <!-- å•†å“ä¿¡æ¯ -->
      <view class="goods-info">
        <image class="goods-image" src="{{item.goodsList[0].image}}" mode="aspectFill"/>
        <view class="goods-detail">
          <view class="goods-title">{{item.goodsList[0].title}}</view>
          <view class="goods-desc">{{item.goodsList[0].specs}}</view>
          <view class="goods-count">x{{item.goodsList[0].quantity}}</view>
        </view>
        <view class="goods-price">
          <text>Â¥{{item.goodsList[0].price}}</text>
        </view>
      </view>
      
      <!-- è®¢å•æ“ä½œ -->
      <view class="order-action">
        <view class="total-section">
          <text class="total-label">å…±{{item.goodsList[0].quantity}}ä»¶å•†å“ åˆè®¡ï¼š</text>
          <text class="total-price">Â¥{{item.totalPrice}}</text>
        </view>
        <view class="btn-group" catchtap>
          <!-- å¾…ä»˜æ¬¾çŠ¶æ€ -->
          <block wx:if="{{item.status === 'UNPAID'}}">
            <button class="btn modify-btn" 
                    catchtap="handleModify" 
                    data-order="{{item}}">ä¿®æ”¹</button>
            <button class="btn cancel-btn" 
                    catchtap="handleCancel" 
                    data-order="{{item}}">å–æ¶ˆ</button>
            <button class="btn pay-btn" 
                    catchtap="handlePayAgain" 
                    data-order="{{item}}">ç»§ç»­ä»˜æ¬¾</button>
          </block>
          
          <!-- å¾…å‘è´§çŠ¶æ€ -->
          <block wx:if="{{item.status === 'UNSHIPPED'}}">
            <button class="btn normal-btn">æé†’å‘è´§</button>
          </block>
          
          <!-- å¾…æ”¶è´§çŠ¶æ€ -->
          <block wx:if="{{item.status === 'UNRECEIVED'}}">
            <button class="btn normal-btn">æŸ¥çœ‹ç‰©æµ</button>
            <button class="btn primary-btn">ç¡®è®¤æ”¶è´§</button>
          </block>
          
          <!-- å¾…è¯„ä»·çŠ¶æ€ -->
          <block wx:if="{{item.status === 'UNRATED'}}">
            <button class="btn primary-btn">è¯„ä»·</button>
          </block>
        </view>
      </view>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-status">
      <view wx:if="{{loading}}" class="loading">åŠ è½½ä¸­...</view>
      <view wx:if="{{finished && orderList.length > 0}}" class="finished">æ²¡æœ‰æ›´å¤šäº†</view>
      <view wx:if="{{finished && orderList.length === 0}}" class="empty">
        <text class="empty-icon">ğŸ“¦</text>
        <text class="empty-text">æš‚æ— ç›¸å…³è®¢å•</text>
      </view>
    </view>
  </scroll-view>
</view> 